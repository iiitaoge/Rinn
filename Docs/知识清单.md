# 知识清单

### 一、 引擎分层架构 (The Layer Cake)

别去背那些学术名词。在 C++ 引擎里，层级意味着**“依赖关系” (Dependency)**。 **下层绝对不能引用上层**（Core 不能引用 Tool，Platform 不能引用 Gameplay）。

这是我给你的 **Rinn Engine** 修正版架构图：

#### 1. Platform Layer (平台层 / 地基)

- **你说的：** 平台层。
- **实质：** **HAL (Hardware Abstraction Layer)**。
- **职责：** 处理脏活累活。窗口管理、文件读写 (IO)、输入设备、图形 API (OpenGL/DirectX)。
- **在本项目中：** **Raylib** 就是这一层。它帮我们屏蔽了 Windows 和 Linux 的区别。

#### 2. Core Layer (核心层 / 基础设施)

- **你说的：** Core。
- **实质：** **Foundation (基石)**。
- **职责：** 这里**不写任何游戏逻辑**。这里只有：
  - **Memory Management:** 内存池，分配器。
  - **Math:** 向量 (Vector2/3)，矩阵运算。
  - **Data Structures:** 你的 **ECS Registry** 和 **Sparse Set** 就在这里。
  - **Logger:** 日志系统。

#### 3. Resource Layer (资源层 / 仓库)

- **你说的：** 资源层。
- **实质：** **Asset Pipeline (资产管线)**。
- **职责：**
  - 加载图片、音频、脚本。
  - **最重要：** 管理生命周期。当关卡结束时，它负责卸载内存，防止泄漏。
  - **Handle System:** 也就是我们之后要做的，给资源发“号码牌”，而不是直接给指针。

#### 4. Function Layer (功能层 / 车间) —— *你需要补充的层*

- **位置：** 在 Core 之上，Gameplay 之下。
- **职责：** **Systems (系统)**。
  - `RenderSystem` (渲染车间)
  - `PhysicsSystem` (物理车间)
  - `AudioSystem` (音频车间)
  - `ScriptSystem` (Lua 虚拟机)

#### 5. Tool Layer (工具层 / 监控室)

- **你说的：** 工具层。
- **实质：** **Editor / Debugger**。
- **职责：** 让开发者能在运行时修改数据。
- **在本项目中：** **ImGui**。我们要做的不是一个独立的编辑器软件，而是**In-Game Editor (游戏内嵌编辑器)**。按下 F1，直接在游戏画面上浮出控制面板。